#pipeline to load data from API to GCS
@data_loader
def load_data(*args, **kwargs):
    links=[]
    link=0
    for m in range(1,13):
        if m<10:
        
        
        
         link =(f'https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2022-{0}{m}.parquet')
         links.append(link)   
         
        else:
            link=(f'https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2022-{m}.parquet')
            links.append(link) 

        
                
    url= links
    appended_data=[]
    
    for item in url:
        df=pd.read_parquet(item)
        appended_data.append(df)

    appended_data=pd.concat(appended_data,axis=0,join='outer',ignore_index=True)
    appended_data['lpep_pickup_datetime']=pd.to_datetime(appended_data['lpep_pickup_datetime'])
    appended_data['lpep_dropoff_datetime']=pd.to_datetime(appended_data['lpep_dropoff_datetime'])     
    """
    Template code for loading data from any source.

    Returns:
        Anything (e.g. data frame, dictionary, array, int, str, etc.)
    """
    # Specify your data loading logic here

    return appended_data
